<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>AR Galaxy Hero</title>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/three.js/build/ar.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
    <style>
      body { margin: 0; overflow: hidden; background-color: black; }
      canvas { display: block; }
    </style>
  </head>
  <body>
    <script>
      // 1. Scene, Camera, Renderer
      let scene = new THREE.Scene();
      let camera = new THREE.Camera();
      scene.add(camera);

      let renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setPixelRatio(window.devicePixelRatio);
      renderer.domElement.style.position = 'absolute';
      renderer.domElement.style.top = '0px';
      renderer.domElement.style.left = '0px';
      document.body.appendChild(renderer.domElement);

      // 2. AR.js Setup
      let arSource = new THREEx.ArToolkitSource({ sourceType: 'webcam' });
      arSource.init(() => setTimeout(() => onResize(), 200));

      window.addEventListener('resize', () => onResize());
      function onResize() {
        arSource.onResize();
        arSource.copySizeTo(renderer.domElement);
        if (arContext.arController !== null) {
          arSource.copySizeTo(arContext.arController.canvas);
        }
      }

      let arContext = new THREEx.ArToolkitContext({
        cameraParametersUrl: 'https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/three.js/data/camera_para.dat',
        detectionMode: 'mono'
      });

      arContext.init(() => camera.projectionMatrix.copy(arContext.getProjectionMatrix()));

      // 3. AR Marker
      let markerRoot = new THREE.Group();
      scene.add(markerRoot);
      let arMarkerControls = new THREEx.ArMarkerControls(arContext, markerRoot, {
        type: 'pattern',
        patternUrl: 'https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/three.js/data/patt.hiro'
      });

      // 4. Hero object (contoh: cube)
      let geometry = new THREE.BoxGeometry(1, 1, 1);
      let material = new THREE.MeshStandardMaterial({ color: 0xff0000 });
      let hero = new THREE.Mesh(geometry, material);
      markerRoot.add(hero);

      // 5. Galaxy particle effect
      let particles = new THREE.Group();
      let particleGeometry = new THREE.SphereGeometry(0.05, 8, 8);
      let particleMaterial = new THREE.MeshBasicMaterial({ color: 0x00ffff });

      for (let i = 0; i < 200; i++) {
        let p = new THREE.Mesh(particleGeometry, particleMaterial);
        p.position.set(
          (Math.random() - 0.5) * 5,
          (Math.random() - 0.5) * 5,
          (Math.random() - 0.5) * 5
        );
        particles.add(p);
      }
      markerRoot.add(particles);

      // 6. Light
      let light = new THREE.PointLight(0xffffff, 1, 100);
      light.position.set(5, 5, 5);
      scene.add(light);

      // 7. Animation Loop
      function animate() {
        requestAnimationFrame(animate);
        if (arSource.ready) arContext.update(arSource.domElement);

        hero.rotation.y += 0.01;
        particles.rotation.y += 0.002;

        renderer.render(scene, camera);
      }
      animate();
    </script>
  </body>
</html>
